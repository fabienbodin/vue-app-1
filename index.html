<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Users</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    <style>
        [v-cloak] {
            display: none;
        }
        * {
            margin:0;
            padding:0;
        }
    </style>
</head>
<body>
    <div id="main" v-cloak>
        <v-app>
            <v-main>
                <v-container>
                    Gestion des utilisateurs

                    <!-- Vuetify va faire l'itération seul grâce à v-data-table.
                      -- 'v-model' correspond aux items sélectionnés.
                      -- 'headers' fait références aux colonnes à afficher
                      -- 'items' = les données
                      -- 'item-key' fait référence à une valeur unique de l'objet (l'uuid)
                      -->
                    <v-data-table
                            v-model="selected"
                            :headers="headers"
                            :items="users"
                            item-key="uuid"
                            show-select
                            class="elevation-1"
                    >
                        <template v-slot:item.actions="{ item }">
                            <v-icon small class="mr-2">mdi-pencil</v-icon>
                            <v-icon small @click="openRemove(item)">mdi-delete</v-icon>
                        </template>
                    </v-data-table>
                </v-container>

                <!-- Contenu des dialogs -->
                <v-row justify="center">
                    <!-- Boîte de dialog pour la suppression -->
                    <v-dialog v-model="dialog.delete.show" max-width="340">
                        <v-card>
                            <v-card-title class="headline" style="word-break: unset">Voulez-vous vraiment supprimer cet utilisateur?</v-card-title>
                            <v-card-text>Cette action est irréversible.</v-card-text>
                            <v-card-actions>
                                <v-spacer></v-spacer>
                                <v-btn class="ma-2" color="darken-1" outlined @click="closeRemove()">Annuler</v-btn>
                                <v-btn class="ma-2" color="indigo darken-1" outlined @click="confirmRemove()">OK</v-btn>
                            </v-card-actions>
                        </v-card>
                    </v-dialog>
                </v-row>
            </v-main>
        </v-app>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.3.2/uuidv4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
    <script>
        new Vue({
            el: '#main',
            vuetify: new Vuetify(),
            data() {
                return {
                    dialog: {
                        delete: {
                            show: false,
                            item: null
                        }
                    },
                    selected: [],
                    headers: [
                        { text: 'UUID', value: 'uuid' },
                        { text: 'Prénom', value: 'firstname' },
                        { text: 'Nom', value: 'lastname' },
                        { text: 'Adresse e-mail', value: 'email' },
                        { text: 'Genre', value: 'gender' },
                        { text: 'Actions', value: 'actions' }
                    ],
                    users: [
                        { uuid: uuidv4(), firstname: "John", lastname: "Doe", email: "john.doe@unknown.com", gender: "Homme" }
                    ]
                }
            },
            methods: {
                openRemove(item) {
                    this.dialog.delete.item = item;
                    this.dialog.delete.show = true;
                },
                closeRemove() {
                    this.dialog.delete.show = false;
                },
                confirmRemove() {
                    this.users.splice(this.dialog.delete.item, 1);
                    this.closeRemove();
                },
            }
        });
    </script>
</body>
</html>
